/*
jQuery UI Virtual Keyboard
Version 1.9.1 minified

Author: Jeremy Satterfield
Modified: Rob Garrison (Mottie on github)
-----------------------------------------
Licensed under the MIT License

Caret code from jquery.caret.1.02.js
Licensed under the MIT License:
http://www.opensource.org/licenses/mit-license.php
-----------------------------------------
*/

(function(e){e.keyboard=function(b,l){var a=this,c;a.$el=e(b);a.el=b;a.$el.data("keyboard",a);a.init=function(){a.options=c=e.extend(true,{},e.keyboard.defaultOptions,l);a.shiftActive=a.altActive=a.metaActive=a.sets=a.capsLock=false;a.lastKeyset=[false,false,false];a.rows=["","-shift","-alt","-alt-shift"];a.acceptedKeys=[];a.mappedKeys={};e('<\!--[if lte IE 8]><script>$("body").addClass("oldie");<\/script><![endif]--\>').appendTo("body").remove();a.msie=e("body").is(".oldie");a.allie=e.browser.msie; a.inPlaceholder=a.$el.attr("placeholder")||"";a.watermark=typeof document.createElement("input").placeholder!=="undefined"&&a.inPlaceholder!=="";a.regex=e.keyboard.comboRegex;a.decimal=/^\./.test(c.display.dec)?true:false;a.repeatTime=1E3/c.repeatRate;a.temp=e('<input style="visibility:hidden" type="text" value="this is a test">').appendTo("body").caret(3,3);a.checkCaret=c.lockInput||a.temp.caret().start!==3?true:false;a.temp.remove();a.temp=["",0,0];e.each("initialized visible change hidden canceled accepted beforeClose".split(" "), function(d,f){e.isFunction(c[f])&&a.$el.bind(f+".keyboard",c[f])});if(c.alwaysOpen)c.stayOpen=true;c.stayOpen||e(document).bind("mousedown.keyboard keyup.keyboard",function(d){a.isVisible&&(d.type==="keyup"&&d.which===27&&a.close(),d.type==="mousedown"&&d.target!==a.el&&e(d.target).closest(".ui-keyboard")[0]!==a.$keyboard[0]&&(a.allie&&(d.preventDefault(),e("body").focus()),a.close(c.autoAccept)))});a.$el.addClass("ui-keyboard-input "+c.css.input).attr({"aria-haspopup":"true",role:"textbox"});(a.$el.is(":disabled")|| a.$el.attr("readonly"))&&a.$el.addClass("ui-keyboard-nokeyboard");c.openOn&&a.$el.bind(c.openOn+".keyboard",function(){a.focusOn()});!a.watermark&&a.$el.val()===""&&a.inPlaceholder!==""&&a.$el.attr("placeholder")!==""&&a.$el.addClass("ui-keyboard-placeholder").val(a.inPlaceholder);a.$el.trigger("initialized.keyboard",[a,a.el]);c.alwaysOpen&&a.reveal()};a.focusOn=function(){if(!a.isVisible||c.alwaysOpen)clearTimeout(a.timer),a.reveal(),c.usePreview||setTimeout(function(){a.preview.focus()},100)};a.reveal= function(){e(".ui-keyboard:not(.ui-keyboard-always-open)").hide();e(".ui-keyboard-has-focus").removeClass("ui-keyboard-has-focus");if(a.$el.is(":disabled")||a.$el.attr("readonly"))a.$el.addClass("ui-keyboard-nokeyboard");else{a.$el.removeClass("ui-keyboard-nokeyboard");c.usePreview||a.$el.unbind(c.openOn?c.openOn+".keyboard":"");typeof a.$keyboard==="undefined"&&a.startup();!a.watermark&&a.el.value===a.inPlaceholder&&a.$el.removeClass("ui-keyboard-placeholder").val("");a.originalContent=a.$el.val(); a.$preview.val(a.originalContent);var d,f=c.position;f.of=f.of||a.$el.data("keyboardPosition")||a.$el;f.collision=c.usePreview?f.collision||"fit fit":"flip flip";a.$keyboard.css({position:"absolute",left:0,top:0}).addClass("ui-keyboard-has-focus").show();if(c.usePreview&&a.msie){if(typeof a.width==="undefined")a.$preview.hide(),a.width=Math.ceil(a.$keyboard.width()),a.$preview.show();a.$preview.width(a.width)}a.$keyboard.position(f);e(window).resize(function(){a.isVisible&&a.$keyboard.position(f)}); a.preview.focus();a.isVisible=true;a.checkDecimal();a.lineHeight=parseInt(a.$preview.css("lineHeight"),10)||parseInt(a.$preview.css("font-size"),10)+4;if(a.msie){d=a.originalContent.length;d={start:d,end:d};if(!a.lastCaret)a.lastCaret=d;if(a.lastCaret.end===0&&a.lastCaret.start>0)a.lastCaret.end=a.lastCaret.start;if(a.lastCaret.start<0)a.lastCaret=d;a.$preview.caret(a.lastCaret.start,a.lastCaret.end)}a.$el.trigger("visible.keyboard",[a,a.el]);return a}};a.startup=function(){a.$keyboard=a.buildKeyboard(); a.$allKeys=a.$keyboard.find("button.ui-keyboard-button");a.$preview=c.usePreview?a.$keyboard.find(".ui-keyboard-preview"):a.$el;a.preview=a.$preview[0];a.$decBtn=a.$keyboard.find(".ui-keyboard-dec");a.wheel=e.isFunction(e.fn.mousewheel);a.alwaysAllowed=[20,33,34,35,36,37,38,39,40,45,46];a.lastCaret={start:0,end:0};a.$preview.bind("keypress.keyboard",function(d){var f=String.fromCharCode(d.charCode||d.which);if(a.checkCaret)a.lastCaret=a.$preview.caret();a.capsLock=f>=65&&f<=90&&!d.shiftKey||f>=97&& f<=122&&d.shiftKey?true:false;if(c.restrictInput){if((d.which===8||d.which===0)&&e.inArray(d.keyCode,a.alwaysAllowed))return;e.inArray(f,a.acceptedKeys)===-1&&d.preventDefault()}else if((d.ctrlKey||d.metaKey)&&(d.which===97||d.which===99||d.which===118||d.which>=120&&d.which<=122))return;a.hasMappedKeys&&a.mappedKeys.hasOwnProperty(f)&&(a.insertText(a.mappedKeys[f]),d.preventDefault());a.checkMaxLength()}).bind("keyup.keyboard",function(d){switch(d.which){case 9:if(a.tab&&!c.lockInput)e.keyboard.keyaction.tab(a), a.tab=false;break;case 27:return a.close(),false}clearTimeout(a.throttled);a.throttled=setTimeout(function(){a.checkCombos()},100);a.checkMaxLength();a.$el.trigger("change.keyboard",[a,a.el])}).bind("keydown.keyboard",function(d){switch(d.which){case 9:if(c.tabNavigation){a.close(c.autoAccept);break}else a.tab=true,d.preventDefault();break;case 13:if(d.shiftKey)return a.close(true),false;break;case 20:a.shiftActive=a.capsLock=!a.capsLock;a.showKeySet(this);break;case 86:if(d.ctrlKey||d.metaKey){if(c.preventPaste){d.preventDefault(); break}a.checkCombos()}}}).bind("mouseup.keyboard",function(){if(a.checkCaret)a.lastCaret=a.$preview.caret()}).bind("blur.keyboard",function(){if(c.alwaysOpen)clearTimeout(a.timer),a.timer=setTimeout(function(){e(":focus")[0]!==a.el&&a.close(c.autoAccept)},300)});c.preventPaste&&(a.$preview.bind("contextmenu.keyboard",function(a){a.preventDefault()}),a.$el.bind("contextmenu.keyboard",function(a){a.preventDefault()}));c.appendLocally?a.$el.after(a.$keyboard):a.$keyboard.appendTo("body");a.$allKeys.bind(c.keyBinding.split(" ").join(".keyboard ")+ ".keyboard",function(d){var f;f=e.data(this,"key");var b=f.action.split(":")[0];a.preview.focus();a.checkCaret&&a.$preview.caret(a.lastCaret.start,a.lastCaret.end);b.match("meta")&&(b="meta");if(e.keyboard.keyaction.hasOwnProperty(b)&&e(this).is(".ui-keyboard-actionkey")){if(e.keyboard.keyaction[b](a,this)===false)return}else if(typeof f.action!=="undefined"&&(f=a.wheel&&!e(this).is(".ui-keyboard-actionkey")?f.curTxt:f.action,a.insertText(f),!a.capsLock&&!c.stickyShift&&!d.shiftKey))a.shiftActive= false,a.showKeySet(this);a.checkCombos();a.checkMaxLength();a.$el.trigger("change.keyboard",[a,a.el]);c.usePreview&&a.preview.focus();d.preventDefault()}).bind("mouseenter.keyboard mouseleave.keyboard",function(d){var f=e(this),b=e.data(this,"key");d.type==="mouseenter"&&a.el.type!=="password"&&f.addClass(c.css.buttonHover).attr("title",function(d,f){return a.wheel&&f===""&&a.sets?c.wheelMessage:f});if(d.type==="mouseleave")b.curTxt=b.original,b.curNum=0,e.data(this,"key",b),f.removeClass(a.el.type=== "password"?"":c.css.buttonHover).attr("title",function(a,d){return d===c.wheelMessage?"":d}).find("span").text(b.original)}).bind("mousewheel.keyboard",function(d,f){if(a.wheel){var c,b=e(this),g=e.data(this,"key");c=g.layers||a.getLayers(b);g.curNum+=f>0?-1:1;if(g.curNum>c.length-1)g.curNum=0;if(g.curNum<0)g.curNum=c.length-1;g.layers=c;g.curTxt=c[g.curNum];e.data(this,"key",g);b.find("span").text(c[g.curNum]);return false}}).bind("mouseup.keyboard mouseleave.kb touchend.kb touchmove.kb touchcancel.kb", function(){a.preview.focus();clearTimeout(a.mouseRepeat)}).filter(":not(.ui-keyboard-actionkey)").add(".ui-keyboard-tab, .ui-keyboard-bksp, .ui-keyboard-space, .ui-keyboard-enter").bind("mousedown.kb touchstart.kb",function(){var d=e(this);a.mouseRepeat=setTimeout(function(){a.repeatKey(d)},c.repeatDelay)})};a.insertText=function(d){var f,c;c=a.$preview.val();var b=a.$preview.caret(),e=a.$preview.scrollLeft();f=a.$preview.scrollTop();var h=c.length;if(b.end<b.start)b.end=b.start;if(b.start>h)b.end= b.start=h;if(a.preview.tagName==="TEXTAREA")a.msie&&c.substr(b.start,1)==="\n"&&(b.start+=1,b.end+=1),c=c.split("\n").length-1,a.preview.scrollTop=c>0?a.lineHeight*c:f;f=d==="bksp"&&b.start===b.end?true:false;d=d==="bksp"?"":d;c=b.start+(f?-1:d.length);e+=parseInt(a.$preview.css("fontSize"),10)*(d==="bksp"?-1:1);a.$preview.val(a.$preview.val().substr(0,b.start-(f?1:0))+d+a.$preview.val().substr(b.end)).caret(c,c).scrollLeft(e);if(a.checkCaret)a.lastCaret={start:c,end:c}};a.checkMaxLength=function(){var d, f=a.$preview.val();if(c.maxLength!==false&&f.length>c.maxLength)d=Math.min(a.$preview.caret().start,c.maxLength),a.$preview.val(f.substring(0,c.maxLength)),a.$preview.caret(d,d),a.lastCaret={start:d,end:d};a.$decBtn.length&&a.checkDecimal()};a.repeatKey=function(d){d.trigger("mousedown.keyboard");a.mouseRepeat=setTimeout(function(){a.repeatKey(d)},a.repeatTime)};a.showKeySet=function(d){var f="",b=(a.shiftActive?1:0)+(a.altActive?2:0);if(!a.shiftActive)a.capsLock=false;if(a.metaActive){if(f=d&&d.name&& /meta/.test(d.name)?d.name:"",f===""?f=a.metaActive===true?"":a.metaActive:a.metaActive=f,!c.stickyShift&&a.lastKeyset[2]!==a.metaActive||(a.shiftActive||a.altActive)&&!a.$keyboard.find(".ui-keyboard-keyset-"+f+a.rows[b]).length)a.shiftActive=a.altActive=false}else if(!c.stickyShift&&a.lastKeyset[2]!==a.metaActive&&a.shiftActive)a.shiftActive=a.altActive=false;b=(a.shiftActive?1:0)+(a.altActive?2:0);f=b===0&&!a.metaActive?"-default":f===""?"":"-"+f;a.$keyboard.find(".ui-keyboard-keyset"+f+a.rows[b]).length? (a.$keyboard.find(".ui-keyboard-alt, .ui-keyboard-shift, .ui-keyboard-actionkey[class*=meta]").removeClass(c.css.buttonAction).end().find(".ui-keyboard-alt")[a.altActive?"addClass":"removeClass"](c.css.buttonAction).end().find(".ui-keyboard-shift")[a.shiftActive?"addClass":"removeClass"](c.css.buttonAction).end().find(".ui-keyboard-lock")[a.capsLock?"addClass":"removeClass"](c.css.buttonAction).end().find(".ui-keyboard-keyset").hide().end().find(".ui-keyboard-keyset"+f+a.rows[b]).show().end().find(".ui-keyboard-actionkey.ui-keyboard"+ f).addClass(c.css.buttonAction),a.lastKeyset=[a.shiftActive,a.altActive,a.metaActive]):(a.shiftActive=a.lastKeyset[0],a.altActive=a.lastKeyset[1],a.metaActive=a.lastKeyset[2])};a.checkCombos=function(){var d,f,b,e,g=a.$preview.val(),h=a.$preview.caret(),j=g.length;if(h.end<h.start)h.end=h.start;if(h.start>j)h.end=h.start=j;a.msie&&g.substr(h.start,1)==="\n"&&(h.start+=1,h.end+=1);c.useCombos&&(g=g.replace(a.regex,function(a,d,b){return c.combos.hasOwnProperty(d)?c.combos[d][b]||a:a}));if(c.restrictInput&& g!==""){b=g;f=a.acceptedKeys.length;for(d=0;d<f;d++)b!==""&&(e=a.acceptedKeys[d],g.indexOf(e)>=0&&(/[\[|\]|\\|\^|\$|\.|\||\?|\*|\+|\(|\)|\{|\}]/g.test(e)&&(e="\\"+e),b=b.replace(RegExp(e,"g"),"")));b!==""&&(g=g.replace(b,""))}h.start+=g.length-j;h.end+=g.length-j;a.$preview.val(g);a.$preview.caret(h.start,h.end);a.preview.scrollTop=a.lineHeight*(g.substring(0,h.start).split("\n").length-1);a.lastCaret={start:h.start,end:h.end};return g};a.checkDecimal=function(){a.decimal&&/\./g.test(a.preview.value)|| !a.decimal&&/\,/g.test(a.preview.value)?a.$decBtn.attr({disabled:"disabled","aria-disabled":"true"}).removeClass(c.css.buttonDefault+" "+c.css.buttonHover).addClass(c.css.buttonDisabled):a.$decBtn.removeAttr("disabled").attr({"aria-disabled":"false"}).addClass(c.css.buttonDefault).removeClass(c.css.buttonDisabled)};a.getLayers=function(a){var c;c=a.attr("data-pos");return a.closest(".ui-keyboard").find('button[data-pos="'+c+'"]').map(function(){return e(this).find("> span").text()}).get()};a.close= function(d){if(a.$keyboard.is(":visible")){clearTimeout(a.throttled);a.$el.trigger(c.alwaysOpen?"":"beforeClose.keyboard",[a,a.el,d||false]).val(d?c.alwaysOpen?a.$el.val():a.checkCombos():a.originalContent).scrollTop(a.el.scrollHeight).trigger(d?"accepted.keyboard":"canceled.keyboard",[a,a.el]).trigger(c.alwaysOpen?"":"hidden.keyboard",[a,a.el]);!c.usePreview&&c.openOn!==""&&a.$el.bind(c.openOn+".keyboard",function(){a.focusOn()});if(!c.alwaysOpen)a.$keyboard.hide(),a.isVisible=false;!a.watermark&& a.el.value===""&&a.inPlaceholder!==""&&a.$el.addClass("ui-keyboard-placeholder").val(a.inPlaceholder)}return false};a.accept=function(){a.close(true)};a.keyBtn=e("<button />").attr({role:"button","aria-disabled":"false",tabindex:"-1"}).addClass("ui-keyboard-button");a.addKey=function(d,b,l){var i,g,h,b=l===true?d:c.display[b]||d,j=l===true?d.charCodeAt(0):d;/\(.+\)/.test(b)&&(g=b.replace(/\(([^()]+)\)/,""),i=b.match(/\(([^()]+)\)/)[1],b=g,h=g.split(":"),g=h[0]!==""&&h.length>1?h[0]:g,a.mappedKeys[i]= g);h=b.split(":");h[0]===""&&h[1]===""&&(b=":");b=h[0]!==""&&h.length>1?e.trim(h[0]):b;i=h.length>1?e.trim(h[1]).replace(/_/g," ")||"":"";g=b.length>1?" ui-keyboard-widekey":"";g+=l?"":" ui-keyboard-actionkey";return a.keyBtn.clone().attr({"data-value":b,name:j,"data-pos":a.temp[1]+","+a.temp[2],title:i}).data("key",{action:d,original:b,curTxt:b,curNum:0}).addClass("ui-keyboard-"+j+g+" "+c.css.buttonDefault).html("<span>"+b+"</span>").appendTo(a.temp[0])};a.buildKeyboard=function(){var b,f,l,i,g, h,j,k=0,n=e("<div />").addClass("ui-keyboard "+c.css.container+(c.alwaysOpen?" ui-keyboard-always-open":"")).attr({role:"textbox"}).hide();c.usePreview?a.$preview=a.$el.clone(false).removeAttr("id").removeAttr("placeholder").removeClass("ui-keyboard-placeholder").addClass("ui-keyboard-preview "+c.css.input).show():(a.$preview=a.$el,c.position.at=c.position.at2);a.$preview.attr(c.lockInput?{readonly:"readonly"}:{});c.usePreview&&e("<div />").addClass("ui-keyboard-preview-wrapper").append(a.$preview).appendTo(n); if(c.layout==="custom"||!e.keyboard.layouts.hasOwnProperty(c.layout))c.layout="custom",e.keyboard.layouts.custom=c.customLayout||{"default":["{cancel}"]};e.each(e.keyboard.layouts[c.layout],function(m,o){if(m!==""){k++;l=e("<div />").attr("name",m).addClass("ui-keyboard-keyset ui-keyboard-keyset-"+m).appendTo(n)[m==="default"?"show":"hide"]();for(f=0;f<o.length;f++){i=e.trim(o[f]).replace(/\{(\.?)[\s+]?:[\s+]?(\.?)\}/g,"{$1:$2}");h=i.split(/\s+/);for(g=0;g<h.length;g++)if(a.temp=[l,f,g],h[g].length!== 0)if(/^\{\S+\}$/.test(h[g]))if(b=h[g].match(/^\{(\S+)\}$/)[1].toLowerCase(),/^sp:(\.?\d+)$/.test(b)&&(j=b.match(/^sp:(\.?\d+)$/)[1]||0,e("<span>&nbsp;</span>").css("margin","0 "+j+"em").addClass("ui-keyboard-button").appendTo(l)),/^meta\d+\:?(\w+)?/.test(b))a.addKey(b,b);else switch(b){case "a":case "accept":a.addKey("accept",b).addClass(c.css.buttonAction);break;case "alt":case "altgr":a.addKey("alt","alt");break;case "b":case "bksp":a.addKey("bksp",b);break;case "c":case "cancel":a.addKey("cancel", b).addClass(c.css.buttonAction);break;case "combo":a.addKey("combo","combo").addClass(c.css.buttonAction);break;case "dec":a.acceptedKeys.push(a.decimal?".":",");a.addKey("dec","dec");break;case "e":case "enter":a.addKey("enter",b).addClass(c.css.buttonAction);break;case "s":case "shift":a.addKey("shift",b);break;case "sign":a.acceptedKeys.push("-");a.addKey("sign","sign");break;case "space":a.acceptedKeys.push(" ");a.addKey("space","&nbsp;");break;case "t":case "tab":a.addKey("tab",b);break;default:e.keyboard.keyaction.hasOwnProperty(b)&& a.addKey(b,b)}else a.acceptedKeys.push(h[g].split(":")[0]),a.addKey(h[g],h[g],true);l.find(".ui-keyboard-button:last").after('<br class="ui-keyboard-button-endrow">')}}});if(k>1)a.sets=true;a.hasMappedKeys=!e.isEmptyObject(a.mappedKeys);return n};a.destroy=function(){e("body").unbind("mousedown.keyboard keyup.keyboard");a.$keyboard&&a.$keyboard.remove();var b=c.openOn+" accepted beforeClose blur canceled change contextmenu hidden initialized keydown keypress keyup visible".split(" ").join(".keyboard "); a.$el.removeClass("ui-keyboard-input ui-keyboard-placeholder ui-keyboard-notallowed ui-keyboard-always-open "+c.css.input).removeAttr("aria-haspopup").removeAttr("role").unbind(b+".keyboard").removeData("keyboard")};a.init()};e.keyboard.keyaction={accept:function(b){b.close(true);return false},alt:function(b,e){b.altActive=!b.altActive;b.showKeySet(e)},bksp:function(b){b.insertText("bksp")},cancel:function(b){b.close();return false},clear:function(b){b.$preview.val("")},combo:function(b){var e=!b.options.useCombos; b.options.useCombos=e;b.$keyboard.find(".ui-keyboard-combo")[e?"addClass":"removeClass"](b.options.css.buttonAction);e&&b.checkCombos();return false},dec:function(b){b.insertText(b.decimal?".":",")},enter:function(b){b.el.tagName!=="INPUT"&&b.insertText("\n")},lock:function(b,e){b.lastKeyset[0]=b.shiftActive=b.capsLock=!b.capsLock;b.showKeySet(e)},meta:function(b,l){b.metaActive=e(l).is("."+b.options.css.buttonAction)?false:true;b.showKeySet(l)},shift:function(b,e){b.lastKeyset[0]=b.shiftActive=!b.shiftActive; b.showKeySet(e)},sign:function(b){/^\-?\d*\.?\d*$/.test(b.$preview.val())&&b.$preview.val(b.$preview.val()*-1)},space:function(b){b.insertText(" ")},tab:function(b){b.el.tagName!=="INPUT"&&b.insertText("\t")}};e.keyboard.layouts={alpha:{"default":["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} a b c d e f g h i j [ ] \\","k l m n o p q r s ; ' {enter}","{shift} t u v w x y z , . / {shift}","{accept} {space} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} A B C D E F G H I J { } |",'K L M N O P Q R S : " {enter}', "{shift} T U V W X Y Z < > ? {shift}","{accept} {space} {cancel}"]},qwerty:{"default":["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}","{accept} {space} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}","{accept} {space} {cancel}"]},international:{"default":["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\", "a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}","{accept} {alt} {space} {alt} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}","{accept} {alt} {space} {alt} {cancel}"],alt:["~ \u00a1 \u00b2 \u00b3 \u00a4 \u20ac \u00bc \u00bd \u00be \u2018 \u2019 \u00a5 \u00d7 {bksp}","{tab} \u00e4 \u00e5 \u00e9 \u00ae \u00fe \u00fc \u00fa \u00ed \u00f3 \u00f6 \u00ab \u00bb \u00ac","\u00e1 \u00df \u00f0 f g h j k \u00f8 \u00b6 \u00b4 {enter}", "{shift} \u00e6 x \u00a9 v b \u00f1 \u00b5 \u00e7 > \u00bf {shift}","{accept} {alt} {space} {alt} {cancel}"],"alt-shift":["~ \u00b9 \u00b2 \u00b3 \u00a3 \u20ac \u00bc \u00bd \u00be \u2018 \u2019 \u00a5 \u00f7 {bksp}","{tab} \u00c4 \u00c5 \u00c9 \u00ae \u00de \u00dc \u00da \u00cd \u00d3 \u00d6 \u00ab \u00bb \u00a6","\u00c4 \u00a7 \u00d0 F G H J K \u00d8 \u00b0 \u00a8 {enter}","{shift} \u00c6 X \u00a2 V B \u00d1 \u00b5 \u00c7 . \u00bf {shift}","{accept} {alt} {space} {alt} {cancel}"]},dvorak:{"default":["` 1 2 3 4 5 6 7 8 9 0 [ ] {bksp}", "{tab} ' , . p y f g c r l / = \\","a o e u i d h t n s - {enter}","{shift} ; q j k x b m w v z {shift}","{accept} {space} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) { } {bksp}",'{tab} " < > P Y F G C R L ? + |',"A O E U I D H T N S _ {enter}","{shift} : Q J K X B M W V Z {shift}","{accept} {space} {cancel}"]},num:{"default":"= ( ) {b},{clear} / * -,7 8 9 +,4 5 6 {sign},1 2 3 %,0 . {a} {c}".split(",")}};e.keyboard.defaultOptions={layout:"qwerty",customLayout:null,position:{of:null,my:"center top",at:"center top", at2:"center bottom"},usePreview:true,alwaysOpen:false,stayOpen:false,display:{a:"\u2714:Accept (Shift-Enter)",accept:"Accept:Accept (Shift-Enter)",alt:"AltGr:Alternate Graphemes",b:"\u2190:Backspace",bksp:"Bksp:Backspace",c:"\u2716:Cancel (Esc)",cancel:"Cancel:Cancel (Esc)",clear:"C:Clear",combo:"\u00f6:Toggle Combo Keys",dec:".:Decimal",e:"\u21b5:Enter",enter:"Enter:Enter",lock:"\u21ea Lock:Caps Lock",s:"\u21e7:Shift",shift:"Shift:Shift",sign:"\u00b1:Change Sign",space:" :Space",t:"\u21e5:Tab",tab:"\u21e5 Tab:Tab"}, wheelMessage:"Use mousewheel to see other keys",css:{input:"ui-widget-content ui-corner-all",container:"ui-widget-content ui-widget ui-corner-all ui-helper-clearfix",buttonDefault:"ui-state-default ui-corner-all",buttonHover:"ui-state-hover",buttonAction:"ui-state-active",buttonDisabled:"ui-state-disabled"},autoAccept:false,lockInput:false,restrictInput:false,tabNavigation:false,appendLocally:false,stickyShift:true,preventPaste:false,maxLength:false,repeatDelay:500,repeatRate:20,openOn:"focus",keyBinding:"mousedown", useCombos:true,combos:{"`":{a:"\u00e0",A:"\u00c0",e:"\u00e8",E:"\u00c8",i:"\u00ec",I:"\u00cc",o:"\u00f2",O:"\u00d2",u:"\u00f9",U:"\u00d9",y:"\u1ef3",Y:"\u1ef2"},"'":{a:"\u00e1",A:"\u00c1",e:"\u00e9",E:"\u00c9",i:"\u00ed",I:"\u00cd",o:"\u00f3",O:"\u00d3",u:"\u00fa",U:"\u00da",y:"\u00fd",Y:"\u00dd"},'"':{a:"\u00e4",A:"\u00c4",e:"\u00eb",E:"\u00cb",i:"\u00ef",I:"\u00cf",o:"\u00f6",O:"\u00d6",u:"\u00fc",U:"\u00dc",y:"\u00ff",Y:"\u0178"},"^":{a:"\u00e2",A:"\u00c2",e:"\u00ea",E:"\u00ca",i:"\u00ee",I:"\u00ce", o:"\u00f4",O:"\u00d4",u:"\u00fb",U:"\u00db",y:"\u0177",Y:"\u0176"},"~":{a:"\u00e3",A:"\u00c3",e:"\u1ebd",E:"\u1ebc",i:"\u0129",I:"\u0128",o:"\u00f5",O:"\u00d5",u:"\u0169",U:"\u0168",y:"\u1ef9",Y:"\u1ef8",n:"\u00f1",N:"\u00d1"}},initialized:null,accepted:null,canceled:null,hidden:null,visible:null,beforeClose:null};e.keyboard.comboRegex=/([`\'~\^\"ao])([a-z])/mig;e.fn.keyboard=function(b){return this.each(function(){new e.keyboard(this,b)})};e.fn.getkeyboard=function(){return this.data("keyboard")}})(jQuery);

(function(e,b,l,a){e.fn.caret=function(c,d){if(typeof this[0]!=="undefined"){var f,e,i,g,h,j;f=document.selection;var k=this[0],n=k.scrollTop;j=window.opera&&window.opera.toString()==="[object Opera]";var m=typeof k.selectionStart!=="undefined";typeof c==="number"&&typeof d==="number"&&(i=c,h=d);return typeof i!=="undefined"?(m?(k.tagName==="TEXTAREA"&&j&&(j=this.val(),f=j.substring(0,i).split("\n")[b]-1,i+=f>0?f:0,h+=f>0?f:0),k.selectionStart=i,k.selectionEnd=h):(f=k.createTextRange(),f.collapse(true), f.moveStart("character",i),f.moveEnd("character",h-i),f.select()),k.focus(),k.scrollTop=n,this):(m?(e=k.selectionStart,g=k.selectionEnd,k.tagName==="TEXTAREA"&&j&&(j=this.val(),f=j.substring(0,e).split("\n")[b]-1,e+=f>0?-f:0,g+=f>0?-f:0)):k.tagName==="TEXTAREA"?(j=this.val(),i=f[l](),h=i[a](),h.moveToElementText(k),h.setEndPoint("EndToEnd",i),e=h.text.replace(/\r\n/g,"\r")[b],g=e+i.text.replace(/\r\n/g,"\r")[b]):(j=this.val().replace(/\r\n/g,"\r"),i=f[l]()[a](),i.moveEnd("character",j[b]),e=i.text=== ""?j[b]:j.lastIndexOf(i.text),i=f[l]()[a](),i.moveStart("character",-j[b]),g=i.text[b]),i=k.value.substring(e,g),{start:e,end:g,text:i,replace:function(a){return k.value.substring(0,e)+a+k.value.substring(g,k.value[b])}})}}})(jQuery,"length","createRange","duplicate");
